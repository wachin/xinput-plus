#!/usr/bin/make -f
export DH_VERBOSE=1

%:
	dh $@

override_dh_auto_build:
	# Compilar traducciones Qt (PyQt6)
	if [ -d i18n ]; then \
	  (command -v lrelease-qt6 >/dev/null && lrelease-qt6 i18n/xinput-plus_*.ts) || \
	  (command -v lrelease >/dev/null && lrelease i18n/xinput-plus_*.ts) || true; \
	fi

override_dh_auto_install:
	# Binario (lanzador)
	install -D -m0755 xinput-plus.py debian/xinput-plus/usr/bin/xinput-plus

	# Desktop + AppStream
	install -D -m0644 debian/xinput-plus.desktop \
	  debian/xinput-plus/usr/share/applications/xinput-plus.desktop
	install -D -m0644 debian/xinput-plus.metainfo.xml \
	  debian/xinput-plus/usr/share/metainfo/xinput-plus.metainfo.xml

	# Icono
	install -D -m0644 src/emucon.svg \
	  debian/xinput-plus/usr/share/icons/hicolor/scalable/apps/xinput-plus.svg

	# Traducciones (.qm)
	if ls i18n/xinput-plus_*.qm >/dev/null 2>&1; then \
	  install -d debian/xinput-plus/usr/share/xinput-plus/i18n; \
	  install -m0644 i18n/xinput-plus_*.qm \
	    debian/xinput-plus/usr/share/xinput-plus/i18n/; \
	fi

override_dh_installchangelogs:
	# Instalar el changelog "upstream" (tu CHANGELOG.md)
	# Ajusta la ruta si lo moviste de carpeta.
	dh_installchangelogs src/CHANGELOG.md
